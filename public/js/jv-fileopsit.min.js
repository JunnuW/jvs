var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
function sendData(a){var b=new XMLHttpRequest,c="",c=[],d;for(d in a)c.push(encodeURIComponent(d)+"="+encodeURIComponent(a[d]));c=c.join("&").replace(/%20/g,"+");b.addEventListener("load",function(a){console.log("Yeah! Data sent and response loaded."+this.responseText);console.log("response status."+this.status)});b.addEventListener("error",function(a){console.log("Oups! Something goes wrong."+this.responseText)});b.open("POST","/hsaveToDb2");b.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
b.send(c)}var selctdNde;
function respToArr(a,b){var c=$("#tabis").tabs("option","active"),d=$("#tabis ul>li a").eq(c).attr("id"),c=$("#FilTreLege").text().lastIndexOf("public");setEdiLbl(-1<c?"Public file":dirUser+"'s file");var e;switch(d){case "Materials":e=b.datArrs;matrlArr=[];d=[b.unit,"n","k",b.description];matrlArr.push(d);var f=e[0].absc,c=e[1].n,h=e[2].k;e=f.length;for(var g=0;g<e;g++)d=[],d.push(f[g]),d.push(c[g]),d.push(h[g]),matrlArr.push(d);$("#ediMater").val(a);matrlArr[0][3]&&$("#descMater").val(matrlArr[0][3]);oMatTable.clear();
oMatTable.rows.add(matrlArr.slice(1));oMatTable.draw();$("#matEditTabl").find("th:eq(0)").text("Unit ["+matrlArr[0][0]+"]");plotNK(matrlArr,8);EnDisButt("Enabled","#btnUseMat");$.notifyBar({cssClass:"success",html:"Material data was read"});break;case "Targets":e=b.datArrs;targArr=[];d=[b.unit,b.spType,b.description];targArr.push(d);f=e[0].absc;c=e[1].percents;e=f.length;for(g=0;g<e;g++)d=[],d.push(f[g]),d.push(c[g]),targArr.push(d);$("#ediTarge").val(a);targArr[0][2]&&$("#descTarge").val(targArr[0][2]);
otargTable.clear();otargTable.rows.add(targArr.slice(1));otargTable.draw();plotRT(targArr,7);EnDisButt("Enabled","#btnUseTarg");$("#targEditTabl").find("th:eq(0)").text("Wavel. ["+targArr[0][0]+"]").find("th:eq(1)").text(targArr[0][1]+" -value");$.notifyBar({cssClass:"success",html:"Spectral target was read"});break;case "Stack":$("#ediStack").val(a);c=JSON.parse(b.matrlStack);$("#descStack").val(c.settings.Descriptor);afterStackRead(c);$.notifyBar({cssClass:"success",html:"Stack data was read"});
break;case "intro":$("#ediStack").val(a);c=JSON.parse(b.matrlStack);$("#descStack").val(c.settings.Descriptor);afterStackRead(c);break;default:alert("no tab-strip")}}
function respToParams(a,b){var c=JSON.stringify(b.params),d=b.header,e=b.description,e=e.replace(/"/g,"");"Inhomogeneous spectrum"==$("#settnDial").dialog("option","title")?($("#inhDesc").html(e),graphSettn.inhomFileN=a):($("#homDesc").html(e),graphSettn.homFileN=a);setSettings(c);setSelections(d);setChkboxes();setLegend();makespArr();makeExpArrs();makeJdos();makeBoltz();makeSommer();calcInhom();calcHom();inhombr()}
function respToEmis(a,b){var c=$("#settnDial").dialog("option","title"),d=b.description,d=d.replace(/"/g,"");"Inhomogeneous spectrum"==c?(graphSettn.inhomFileN=a,inhomSpectr.experPlot=makeEmisArr(b),inhomSpectr.experArr=makeEmisArr(b),$("#inhDescLbl").css("display","inline"),$("#inhDesc").css("display","inline"),$("#inhDesc").html(d),inhombr()):"Homogeneous spectrum"==c&&(graphSettn.homFileN=a,homSpectr.experArr=makeEmisArr(b),homSpectr.experPlot=makeEmisArr(b),$("#homDescLbl").css("display","inline"),
$("#homDesc").css("display","inline"),$("#homDesc").html(d),hombr())}function makeEmisArr(a){var b=[],c=[a.unit,"Intensity",a.description];b.push(c);var d=a.datArrs[0].eVs;a=a.datArrs[1].Inte;for(var e=d.length,f=0;f<e;f++)c=[],c.push(d[f]),c.push(a[f]),b.push(c);return b}
function handleFail(a,b){var c=JSON.parse(a);console.log("failu.statCode: "+c.statCode);console.log("failu.resString: "+c.resString);var d;switch(c.statCode){case 500:case 400:case 403:d=b+": "+c.resString;break;case 404:d=b+"  , error in Url?: "+saveUrl;break;case 413:d=b+"  ,too much data?";break;case 204:d=b+"  File was not found"}$.notifyBar({cssClass:"error",html:d})}
function toJsonArr(a,b,c,d){var e={};e.Collection=a;e.Filename=b;d=d.replace(/(^[\"\']+)|([\"\']+$)/g,"");e.Descr=d;if(2>c.length)e.Unit="";else{b=c[0][0];if("nm"!=b&&"um"!=b&&"eV"!=b)throw Error("Unknown spectral unit "+b);e.Unit=b;b=[];d=c.length;if("materials"==a){var f=[],h=[];for(a=1;a<d;a++)b.push(c[a][0]),f.push(c[a][1]),h.push(c[a][2]);e.n=f;e.k=h}else{f=[];for(a=1;a<d;a++)b.push(c[a][0]),f.push(c[a][1]);e.type=c[0][1];e.Sv=f}e.absc=b}return e}
function ReadLocFle(a,b){var c=new FileReader,d;if(a){d=setTimeout(function(){$("#CancelReadForm").dialog("open");$("#CancelReadForm b").text("15s time-out passed: Continue/Cancel?")},15E3);var e;c.onloadend=function(a){e=a.target.result;clearTimeout(d);b(e)};c.onerror=locFleErrorHandler;c.readAsText(a,"UTF-8")}}
function gotTextFile(a){var b=$("#tabis").tabs("option","active");switch($("#tabis ul>li a").eq(b).attr("id")){case "Materials":matrlArr=splitToArr(a);oMatTable.clear();oMatTable.rows.add(matrlArr.slice(1));oMatTable.draw();$("#matEditTabl").find("th:eq(0)").text("Unit ["+matrlArr[0][0]+"]");$("#descMater").val(matrlArr[0][3]);plotNK(matrlArr,8);EnDisButt("Enabled","#btnUseMat");break;case "Targets":targArr=splitToArr(a);$("#descTarge").val(targArr[0][2]);otargTable.clear();otargTable.rows.add(targArr.slice(1));
otargTable.draw();-1<targArr[0][1].indexOf("R")?$("#targMode").text("Target spectrum for reflectance:"):$("#targMode").text("Target spectrum for transmission:");$("#targEditTabl").find("th:eq(0)").text("Wavel. ["+targArr[0][0]+"]");$("#targEditTabl").find("th:eq(1)").text(targArr[0][1]+" -value");targArr[0][2]&&$("#descTarge").val(targArr[0][2]);plotRT(targArr,7);EnDisButt("Enabled","#btnUseTarg");break;case "Stack":a=stack=JSON.parse(a),afterStackRead(a)}}
function locFleErrorHandler(a){switch(a.target.error.code){case a.target.error.NOT_FOUND_ERR:alert("File Not Found!");break;case a.target.error.NOT_READABLE_ERR:alert("File is not readable");break;case a.target.error.ABORT_ERR:break;default:alert("An error occurred reading this file.")}}
function splitToArr(a){var b,c,d=[],e=[],f=[];a=a.split(/\r\n|\r|\n/g);e.push(a[0].split("\t"));for(var h=a.length,g=1;g<h;g++){b=[];a[g]=a[g].replace(/^\t|\t$/g,"");b=a[g].split("\t");c=[];for(var k=0;k<b.length;k++)c.push(parseFloat(b[k]));0<parseFloat(c[0])&&0<parseFloat(c[1])?(c[2]||"k"!=e[2]||(c[2]=0),d.push(c)):f.push(c)}1<d.length&&d.sort(function(a,b){return a[0]-b[0]});if(1<d.length)for(f=0;f<d.length;f++)e.push(d[f]);else for(d=0;d<f.length;d++)e.push(f[d]);return e}
function fleNamer(a,b){if(1>a.length)alert("Filename is required");else{a=a.replace(/(^\/)|(\/$)/g,"");var c=/^[-_\/\sa-z0-9]+$/i;if(c.test(a))if(b=b.replace(/(^\/)|(\/$)/g,""),!c.test(b)&&0<b.length)alert("Invalid directory name: "+b);else return 0==a.indexOf(b)?a:b+"/"+a;else alert("Invalid filename: "+a)}}
function simParHeader(){var a;a={Estart:simSettn.eVstart,Estop:simSettn.eVstop,Etr:simSettn.eTr};console.log("Etr: ",a.eTr);inhomSpectr.inPlot.jdos&&(a.jdos=simSettn.jdostype);if(inhomSpectr.inPlot.Se){var b={};b.Eb_meV=simSettn.exEb;"bulk"==simSettn.jdostype?b.type="Bulk-3D":(b.type="QW-2D",b.viewDir=simSettn.viewDir,b.polarizat=simSettn.polarizat,"TM"==simSettn.polarizat&&(b.shapePar=simSettn.ex0));a.exiton=b}inhomSpectr.inPlot.fcv&&(a.Boltzmann={Epeak_eV:a.Etr,Temp_K:simSettn.kelvin});inhomSpectr.inPlot.Lurb&&
(inhomSpectr.inPlot.convo?a.InhmgBrdng={type:"AsymUrbach",Eu_meV:simSettn.eU}:a.FuncPlot={type:"AsymUrbach",Eu_meV:simSettn.eU});inhomSpectr.inPlot.Lsurb&&(inhomSpectr.inPlot.convo?a.InhmgBrdng={type:"SymmUrbach",Eu_meV:simSettn.eU}:a.FuncPlot={type:"SymmUrbach",Eu_meV:simSettn.eU});inhomSpectr.inPlot.Lgaus&&(inhomSpectr.inPlot.convo?a.InhmgBrdng={type:"Gaussian",sigma_meV:simSettn.GauSig}:a.FuncPlot={type:"Gaussian",sigma_meV:simSettn.GauSig});inhomSpectr.inPlot.Lsech&&(inhomSpectr.inPlot.convo?
a.InhmgBrdng={type:"Sech^n(t/tau)",tau_fs:simSettn.SechTau,n:simSettn.SechN}:a.FuncPlot={type:"Sech^n(t/tau)",tau_fs:simSettn.SechTau,n:simSettn.SechN});"Homogeneous simulation"==$("#lblsaveSimSpe").text()&&homSpectr.inPlot.convo&&($("#pltLorentz").prop("checked")&&(a.HomogBrdng={type:"Lorentz",tau_fs:simSettn.LorTau}),$("#pltDlorentz").prop("checked")&&(a.HomogBrdng={type:"Lorentz X Lorentz",tau1_fs:simSettn.DlTau1,tau2_fs:simSettn.DlTau2}));"Homogeneous simulation"!=$("#lblsaveSimSpe").text()||
homSpectr.inPlot.convo||($("#pltLorentz").prop("checked")&&(a.FuncPlot={type:"Lorentz",tau_fs:simSettn.LorTau}),$("#pltDlorentz").prop("checked")&&(a.FuncPlot={type:"Lorentz1 X Lorentz2",tau1_fs:simSettn.DlTau1,tau2_fs:simSettn.DlTau2}));return a}
function makeSimHeader(){var a="";inhomSpectr.inPlot.eV&&(a+="(E)");inhomSpectr.inPlot.jdos&&(a="qw"==simSettn.jdostype?a+"(qw-jdos)":a+"(bulk-jdos)");inhomSpectr.inPlot.fcv&&(a+="(exp[(E-Etr)/kT])");inhomSpectr.inPlot.Se&&(a="qw"==simSettn.jdostype?a+"(qw-ex.Enh)":a+"(bulk-ex.Enh)");inhomSpectr.inPlot.convo&&(inhomSpectr.inPlot.Lurb?a+="*(Asym.Urbach-brdng)":inhomSpectr.inPlot.Lsurb?a+="*(Symm.Urbach-brdng)":inhomSpectr.inPlot.Lgaus?a+="*(Gaussian-brdng)":inhomSpectr.inPlot.Lsech&&(a+="*(Sech^n(t/tau/n)-brdng)"));
3>a.length&&(inhomSpectr.inPlot.Lurb&&(a="Asymmetric Urbach function"),inhomSpectr.inPlot.Lsurb&&(a="Symmetric Urbach function"),inhomSpectr.inPlot.Lgaus&&(a="Gaussian function"),inhomSpectr.inPlot.Lsech&&(a="FFT{sech^n(t/tau/n)}"));a=a.replace(/\)\(/g,")x(");"Homogeneous simulation"==$("#lblsaveSimSpe").text()&&(homSpectr.inPlot.convo?($("#pltLorentz").prop("checked")&&(a+="*(Lorentzian brdng)"),$("#pltDlorentz").prop("checked")&&(a+="*(Lorentzian1 x Lorentzian2 brdng)")):(a="",$("#pltLorentz").prop("checked")&&
(a="Lorentzian function"),$("#pltDlorentz").prop("checked")&&(a="(Lorentzian1 X Lorentzian2) function")));return a}
function simulSaveDat(){var a=$("#numSel option:selected").text(),a=0<a?Math.floor(inhomSpectr.numPoints/a):1,b=$("#lblsaveSimSpe").text(),c="",d=inhomSpectr.numPoints-1;if("Inhomogeneous simulation"==b)c+="E [eV]\tInhomog\n";else if("Homogeneous simulation"==b)c+="E [eV]\tHomog\n";else{console.log("unexpected checkbox label, saving selector");return}for(var e,f=0;f<d;f+=a)0==f%a&&(e="Inhomogeneous simulation"==b?inhomSpectr.plotArr[f]:homSpectr.plotArr[f],c+=inhomSpectr.eVarr[f]+"\t"+e+"\n");0!=
d%a&&(e="Inhomogeneous simulation"==b?inhomSpectr.plotArr[d]:homSpectr.plotArr[d],c+=inhomSpectr.eVarr[d]+"\t"+e+"\n");return c}function makeOptsArr(a){for(var b=a.length,c=[],d,e=0;e<b;e++)d=[],d.push(e),d.push(a[e].Name),d.push(a[e].Data[0][0]),d.push(a[e].Data.length),d.push(a[e].Owner),d.push(a[e].File),c.push(d);return c}
function seiv_loucal(a,b,c){var d=document.createElement("a");document.body.appendChild(d);d.setAttribute("href","data:text/plain;charset=utf-8,"+encodeURIComponent(b));d.setAttribute("download",a);d.target="_self";d.click();c(a)}
function experEmisDat(){var a="",b,c;b=$("#settnDial").dialog("option","title");if("Inhomogeneous spectrum"==b)for(a=inhomSpectr.experArr[0][2].replace(/"/g,""),a="eV\tIntensity\t"+a,b=inhomSpectr.experArr.length,c=1;c<b;c++)a=a+"\r"+inhomSpectr.experArr[c][0]+"\t"+inhomSpectr.experArr[c][1];else if("Homogeneous spectrum"==b)for(a=homSpectr.experArr[0][2].replace(/"/g,""),a="eV\tIntensity\t"+a,b=homSpectr.experArr.length,c=1;c<b;c++)a=a+"\r"+homSpectr.experArr[c][0]+"\t"+homSpectr.experArr[c][1];
return a}function matrlToLocFile(a){console.log("Saved material to local file: "+a)}function targetToLocFile(a){EnDisButt("Enabled","#btnUseTarg");console.log("Saved target to local file: "+a)}function stackToLocFile(a){console.log("Saved stack to local file: "+a)}function emisToLocFile(a){console.log("Saved emission spectrum local file: "+a)}function sorttaa(a){var b=a.slice(0,1);a=a.slice(1);a.sort(function(a,b){return a[0]-b[0]});return b.concat(a)}
function get_cookies_array(){var a={};if(document.cookie&&""!=document.cookie)for(var b=document.cookie.split(";"),c=0;c<b.length;c++){var d=b[c].split("=");d[0]=d[0].replace(/^ /,"");a[decodeURIComponent(d[0])]=decodeURIComponent(d[1])}return a}function setEdiLbl(a){var b=$("#tabis").tabs("option","active");switch($("#tabis ul>li a").eq(b).attr("id")){case "Materials":$("#ediMaterLbl").text(a);break;case "Targets":$("#ediTargeLbl").text(a);break;case "Stacks":$("#ediStackLbl").text(a)}}
function menuTitle(a){var b=a.indexOf(".");0>b&&(b=a.length);a=a.slice(0,b);b=a.lastIndexOf("/")+1;a=a.slice(b);b=a.lastIndexOf("\\")+1;return a=a.slice(b)};
