var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Math.log10",function(a){return a?a:function(a){return Math.log(a)/Math.LN10}},"es6-impl","es3");
var userName="No login",dirUser="Publ",kBoltz=1.38064852E-23,eCha=1.60217662E-19,hBar=1.0545718E-34,hPlanck=6.62607004E-34,fftN=2048,inhomSpectr={},homSpectr={},simSettn={};inhomSpectr.numPoints=1E3;homSpectr.numPoints=inhomSpectr.numPoints;inhomSpectr.inPlot={eV:!1,jdos:!1,Se:!1,fcv:!0,Lurb:!1,Lsurb:!1,Lgaus:!1,Lsech:!1,convo:!1};homSpectr.inPlot={convo:!1,exper:!1};inhomSpectr.eVarr=[];inhomSpectr.jdosArr=[];inhomSpectr.exenArr=[];inhomSpectr.fcvArr=[];inhomSpectr.Lih=[];inhomSpectr.plotArr=[];
inhomSpectr.experArr=[];inhomSpectr.experPlot=[];homSpectr.plotArr=[];homSpectr.experArr=[];homSpectr.experPlot=[];simSettn={eVstart:1.3,eVstop:1.7,eVTr:1.35,kelvin:293,jdostype:"qw",exEb:5,viewDir:"parallel",polarizat:"TE",ex0:2,eU:8,GauSig:7,SechTau:100,SechN:1,LorTau:100,DlTau1:100,DlTau2:100};makespArr();
Object.defineProperty(simSettn,"eTr",{set:function(a){a>this.eVstart&&a<this.eVstop?(a=(inhomSpectr.numPoints-1)*(a-this.eVstart)/(this.eVstop-this.eVstart),a=Math.round(a)):a=Math.round(inhomSpectr.numPoints/2);this.eVTr=inhomSpectr.eVarr[a];$("#Et_touch").val(inhomSpectr.eVarr[a].toFixed(3))},get:function(){return this.eVTr}});graphSettn={inhomLegend:"",homLegend:"",inhomLinlog:"lin",homLinlog:"log",inhomFileN:"",homFileN:""};simSettn.eTr=1.4;
var optiot={xaxes:[{position:"bottom",axisLabel:"Energy eV"}],yaxes:[{position:"left",axisLabel:"Relative Intensity"}],legend:{position:"ne"},grid:{margin:{top:35},hoverable:"Relative Intensity"},canvas:!0},plot=$.plot("#ph1_inhomog",[],optiot),plot2=$.plot("#ph2_homog",[],optiot),dataa=[{data:LinOrLogs(graphSettn.inhomLinlog,inhomSpectr.plotArr,plot),xaxis:1,yaxis:1,label:graphSettn.inhomLegend}];
function setQwRadio(){"parallel"==simSettn.viewDir?($("#dirPar").prop("checked",!0),$("#dirPerp").prop("checked",!1)):($("#dirPar").prop("checked",!1),$("#dirPerp").prop("checked",!0));"TE"==simSettn.polarizat?($("#enhTE").prop("checked",!0),$("#enhTM").prop("checked",!1)):($("#enhTE").prop("checked",!1),$("#enhTM").prop("checked",!0))}
function setJdosRadio(){"bulk"==simSettn.jdostype?($("#bulkJDOS").prop("checked",!0),$("#qwendetls").css("display","none"),$("#qwdetails .hideshow").hide()):($("#qwJDOS").prop("checked",!0),$("#qwendetls").css("display","inline"),$("#qwdetails .hideshow").show())}makeJdos();makeBoltz();setChkboxes();setLegend();makeSommer();calcInhom();$("#paramDial").dialog({width:700,autoOpen:!1,maxHeight:"700px",overflow:"auto",show:{effect:"blind",duration:500},hide:{effect:"explode",duration:200}});
$("#settnDial").dialog({width:700,autoOpen:!1,maxHeight:"700px",overflow:"auto",show:{effect:"blind",duration:500},hide:{effect:"explode",duration:200}});var srvrFileTxt="Open emission spectrum",DFmngo=$("#mongoDialForm");DFmngo.dialog("option","title",srvrFileTxt);$("#openFile").click(function(){$("#settnDial").dialog("close");DFmngo.dialog("option","width","700px").dialog("option","title",srvrFileTxt).dialog("open");$("#frm-DirSel").show();$("#openOpti").css("display","inline")});
$("#saveFile").click(function(){var a=$("#settnDial").dialog("option","title");"Inhomogeneous spectrum"==a?$("#lblsaveSimSpe").text("Inhomogeneous simulation"):$("#lblsaveSimSpe").text("Homogeneous simulation");$("#chkSaveSimu").prop("checked")?$("#numSel").prop("disabled",!1):$("#numSel").prop("disabled",!0);1>homSpectr.experArr.length&&"Homogeneous spectrum"==a||1>inhomSpectr.experArr.length&&"Inhomogeneous spectrum"==a?$("#chkSaveExper").attr("disabled",!0):$("#chkSaveExper").attr("disabled",!1);
$("#settnDial").dialog("close");DFmngo.dialog("option","width","700px").dialog("option","title","Save emission spectrum").dialog("open");$("#openOpti").css("display","none")});
function inhomSettns_dialog(){$("#spWhat").css("display","block");$("#spLorentz").css("display","none");$("#spDlorentz").css("display","none");$("#bConvolOpt").text("Broadening (convolution) options for Lih:");$("#divEpsilon").css("display","block");$("#divJdos").css("display","block");$("#divSommerf").css("display","block");$("#divFcv").css("display","block");$("#divUrbach").css("display","block");$("#divSurbach").css("display","block");$("#divGaussian").css("display","block");$("#divSech").css("display",
"block");$("#divLorentz").css("display","none");$("#divDLorentz").css("display","none");$("#divHomogConv").css("display","none");$("#divNormalize").css("display","block");$("#settnDial").dialog("option","title","Inhomogeneous spectrum");$("#bPlotSel1").css("display","block");$("#bPlotSel2").css("display","none");$("#settnDial").dialog("open");$("#saveFile").css("display","inline");setJdosRadio();setQwRadio()}$("#ph1_inhomog").dblclick(function(){inhomSettns_dialog()});
function homogSettns_dialog(){$("#spSech").css("display","none");$("#spGaussian").css("display","none");$("#spSurbach").css("display","none");$("#spUrbach").css("display","none");$("#spWhat").css("display","block");$("#bConvolOpt").text("Homogeneous line shape options for Lh:");$("#divEpsilon").css("display","block");$("#divJdos").css("display","block");$("#divSommerf").css("display","block");$("#divFcv").css("display","block");$("#divUrbach").css("display","none");$("#divSurbach").css("display",
"none");$("#divGaussian").css("display","none");$("#divSech").css("display","none");$("#divLorentz").css("display","block");$("#divDLorentz").css("display","block");$("#divHomogConv").css("display","block");$("#divNormalize").css("display","block");$("#settnDial").dialog("option","title","Homogeneous spectrum");$("#bPlotSel2").css("display","block");$("#bPlotSel1").css("display","none");$("#settnDial").dialog("open");$("#saveFile").css("display","inline")}$("#ph2_homog").dblclick(function(){homogSettns_dialog()});
$("#eVstart_touch").TouchSpin({max:4.5,min:0,step:.001,initval:simSettn.eVstart,decimals:3,boostat:10,maxboostedstep:.005,postfix:"eV",mousewheel:!0});$("#eVstart_touch").on("touchspin.on.stopspin",function(a){a=Number($("#eVstart_touch").val());simSettn.eVstart=a.toFixed(3);a+=.1;$("#eVstop_touch").trigger("touchspin.updatesettings",{min:a})});$("#eVstop_touch").TouchSpin({max:4.5,min:0,step:Number(.001),initval:simSettn.eVstop,decimals:3,boostat:10,maxboostedstep:.005,postfix:"eV",mousewheel:!0});
$("#eVstop_touch").on("touchspin.on.stopspin",function(a){a=Number($("#eVstop_touch").val());simSettn.eVstop=a.toFixed(3);a-=.1;$("#eVstart_touch").trigger("touchspin.updatesettings",{max:a})});$("#Et_touch").TouchSpin({max:4,min:simSettn.eVstart+.01,step:Number(.001),initval:simSettn.eTr,decimals:3,boostat:10,maxboostedstep:.005,postfix:"eV",mousewheel:!0});
$("#Et_touch").on("touchspin.on.stopspin",function(a){a=Number($("#Et_touch").val());simSettn.eTr=a;makeJdos();makeBoltz();makeSommer();calcInhom();calcHom()});$("#TemK_touch").TouchSpin({max:600,min:0,step:Number(1),initval:simSettn.kelvin,decimals:0,boostat:10,maxboostedstep:5,postfix:"T[K]",mousewheel:!0});$("#TemK_touch").on("touchspin.on.stopspin",function(a){a=Number($("#TemK_touch").val());simSettn.kelvin=a.toFixed(0);makeBoltz();calcInhom();calcHom()});
$("#eVbind_touch").TouchSpin({max:20,min:.01,step:.01,initval:simSettn.exEb,decimals:2,boostat:5,maxboostedstep:.1,postfix:"meV",mousewheel:!0});$("#eVbind_touch").on("touchspin.on.stopspin",function(a){a=Number($("#eVbind_touch").val());simSettn.exEb=a;makeSommer();calcInhom();calcHom()});$("#ex0_touch").TouchSpin({max:50,min:.01,step:.01,initval:simSettn.ex0,decimals:2,boostat:5,maxboostedstep:.1,postfix:"meV",mousewheel:!0});
$("#ex0_touch").on("touchspin.on.stopspin",function(a){a=Number($("#ex0_touch").val());simSettn.ex0=a;makeSommer();calcInhom();calcHom()});$("#eveu_touch").TouchSpin({max:50,min:0,step:.1,initval:simSettn.eU,decimals:1,boostat:5,maxboostedstep:1,postfix:"meV",mousewheel:!0});$("#eveu_touch").on("touchspin.on.stopspin",function(a){a=Number($(this).val());simSettn.eU=a.toFixed(1);calcInhom();calcHom()});
$("#gausig_touch").TouchSpin({max:100,min:1,step:.1,initval:simSettn.GauSig,decimals:1,boostat:5,maxboostedstep:1,postfix:"meV",mousewheel:!0});$("#gausig_touch").on("touchspin.on.stopspin",function(a){a=Number($(this).val());simSettn.GauSig=a.toFixed(1);calcInhom();calcHom()});$("#sechN_touch").TouchSpin({max:10,min:.01,step:.01,initval:simSettn.SechN,decimals:2,boostat:5,maxboostedstep:.25,postfix:"",mousewheel:!0});
$("#sechN_touch").on("touchspin.on.stopspin",function(a){a=Number($(this).val());simSettn.SechN=a.toFixed(2);calcInhom();calcHom()});$("#sechTau_touch").TouchSpin({max:1E3,min:10,step:1,initval:simSettn.SechTau,decimals:0,boostat:5,maxboostedstep:10,postfix:"[fs]",mousewheel:!0});$("#sechTau_touch").on("touchspin.on.stopspin",function(a){a=Number($(this).val());simSettn.SechTau=a.toFixed(0);calcInhom();calcHom()});
$("#tauR_touch").TouchSpin({max:2E3,min:1,step:1,initval:simSettn.LorTau,decimals:0,boostat:5,maxboostedstep:10,postfix:"[fs]",mousewheel:!0});$("#tauR_touch").on("touchspin.on.stopspin",function(a){a=Number($(this).val());simSettn.LorTau=a.toFixed(0);selBroadFun(Lorentz,"Lorentz");calcHom()});$("#tauBe_touch").TouchSpin({max:500,min:1,step:1,initval:simSettn.DlTau1,decimals:0,boostat:5,maxboostedstep:10,postfix:"[fs]",mousewheel:!0});
$("#tauBe_touch").on("touchspin.on.stopspin",function(a){a=Number($(this).val());simSettn.DlTau1=a.toFixed(0);selBroadFun(Dlorentz,"Dlorentz");calcHom()});$("#tauBh_touch").TouchSpin({max:500,min:1,step:1,initval:simSettn.DlTau2,decimals:0,boostat:5,maxboostedstep:10,postfix:"[fs]",mousewheel:!0});$("#tauBh_touch").on("touchspin.on.stopspin",function(a){a=Number($(this).val());simSettn.DlTau2=a.toFixed(0);selBroadFun(Dlorentz,"Dlorentz");calcHom()});
function selBroadFun(a,b){if($("#pltHomConv").is(":checked")){var c=makeFftKernel(a),d=padArray(inhomSpectr.plotArr);homSpectr.plotArr=unPad(fftConvo(d,c))}else broadFuns(b);hombr()}setJdosRadio();setQwRadio();
$("input[type=radio][name=jdos]").change(function(){"bulk"==this.value?(simSettn.jdostype="bulk",$("#qwendetls").css("display","none"),$("#qwdetails .hideshow").hide()):"qw"==this.value&&(simSettn.jdostype="qw",$("#qwendetls").css("display","block"),$("#qwdetails .hideshow").hide());setJdosRadio();makeJdos();makeSommer();calcInhom()});
$("input[type=radio][name=dirBut]").change(function(){$("#haideri").hide();$("#enhTE").prop("checked",!0);$("#enhTM").prop("checked",!1);simSettn.polarizat="TE";"parallel"==this.value?($("#enhTE").attr("disabled",!1),$("#enhTM").attr("disabled",!1),simSettn.viewDir="parallel"):"perpend"==this.value&&($("#enhTE").attr("disabled",!0),$("#enhTM").attr("disabled",!0),simSettn.viewDir="perpend");makeSommer();calcInhom()});
$("input[type=radio][name=enhBut]").change(function(){"TE"==this.value?(simSettn.polarizat="TE",$("#haideri").hide()):"TM"==this.value&&(simSettn.polarizat="TM",$("#haideri").css("display","inline"));makeSommer();calcInhom()});
function inhombr(){var a=plot.getOptions();if(inhomSpectr.plotArr.length<inhomSpectr.numPoints)alert("no data for plotting!");else{a.yaxes[0].axisLabel="log"==graphSettn.inhomLinlog?"Log10  Intensity":"Rel. Intensity";a=[{data:LinOrLogs(graphSettn.inhomLinlog,inhomSpectr.plotArr,plot),color:"#4d94ff",xaxis:1,yaxis:1,label:graphSettn.inhomLegend},{data:LinOrLogExp(inhomSpectr.experArr,graphSettn.inhomLinlog),color:"#ffb380",xaxis:1,yaxis:1,label:"Measured"}];plot.setData(a);plot.setupGrid();plot.draw();
var b="qw"==simSettn.jdostype?"using qw-jdos":"using bulk-jdos",c=plot.getCanvas(),a=c.getContext("2d");a.font="12pt sans-serif";a.lineWidth=2;a.strokeStyle="#4d94ff";a.strokeText(b,20,15);a.strokeStyle="#ffb380";b=c.scrollWidth;b=Math.ceil(b/2);a.strokeText(graphSettn.inhomFileN,b,15);hombr()}}
function hombr(){var a=plot2.getOptions(),b=plot2.getCanvas(),c=b.getContext("2d");c.font="12pt sans-serif";c.lineWidth=2;a.yaxes[0].axisLabel="log"==graphSettn.homLinlog?"Log10  Intensity":"Rel. Intensity";$("#pltNormalize").is(":checked")&&arrNormalize(homSpectr.plotArr);$("#pltHomConv").is(":checked")?a=graphSettn.inhomLegend+"*Lh":(a="",$("#pltLorentz").prop("checked")&&(a="Lorentz"),$("#pltDlorentz").prop("checked")&&(a="Lorentz1 x Lorentz2"));homSpectr.plotArr.length==homSpectr.numPoints&&1<
homSpectr.experArr.length?(a=[{data:LinOrLogs(graphSettn.homLinlog,inhomSpectr.plotArr,plot2),color:"#4d94ff",xaxis:1,yaxis:1,label:graphSettn.inhomLegend},{data:LinOrLogs(graphSettn.homLinlog,homSpectr.plotArr,plot2),color:"#00cc00",xaxis:1,yaxis:1,label:a},{data:LinOrLogExp(homSpectr.experArr,graphSettn.homLinlog),color:"#ff6666",xaxis:1,yaxis:1,label:"Measured"}],plot2.setData(a),plot2.setupGrid(),plot2.draw(),c.strokeStyle="#4d94ff",c.strokeText("Inhom.Sim.",20,15),c.strokeStyle="#00cc00",c.strokeText("Homog.Sim",
120,15),c.strokeStyle="#ff6666",b=b.scrollWidth,b=Math.ceil(b/2),c.strokeText(graphSettn.homFileN,b,15)):homSpectr.plotArr.length==homSpectr.numPoints&&1>homSpectr.experArr.length?(a=[{data:LinOrLogs(graphSettn.homLinlog,inhomSpectr.plotArr,plot2),color:"#4d94ff",xaxis:1,yaxis:1,label:graphSettn.inhomLegend},{data:LinOrLogs(graphSettn.homLinlog,homSpectr.plotArr,plot2),color:"#00cc00",xaxis:1,yaxis:1,label:a}],plot2.setData(a),plot2.setupGrid(),plot2.draw(),c.strokeStyle="#4d94ff",c.strokeText("Inhom.Sim.",
20,15),c.strokeStyle="#00cc00",c.strokeText("Homog.Sim",120,15)):homSpectr.plotArr.length<homSpectr.numPoints&&1<homSpectr.experArr.length?(a=[{data:LinOrLogs(graphSettn.homLinlog,inhomSpectr.plotArr,plot2),color:"#4d94ff",xaxis:1,yaxis:1,label:graphSettn.inhomLegend},{data:LinOrLogExp(homSpectr.experArr,graphSettn.homLinlog),color:"#ff6666",xaxis:1,yaxis:1,label:"Measured"}],plot2.setData(a),plot2.setupGrid(),plot2.draw(),c.strokeStyle="#4d94ff",c.strokeText("Inhom.Sim.",20,15),c.strokeStyle="#ff6666",
b=b.scrollWidth,b=Math.ceil(b/2),c.strokeText(graphSettn.homFileN,b,15)):(a=[{data:LinOrLogs(graphSettn.homLinlog,inhomSpectr.plotArr,plot2),color:"#4d94ff",xaxis:1,yaxis:1,label:graphSettn.inhomLegend}],plot2.setData(a),plot2.setupGrid(),plot2.draw(),c.strokeStyle="#4d94ff",c.strokeText("Inhom.Sim.",20,15))}
function makespArr(){var a=parseFloat(simSettn.eVstart),b=parseFloat(simSettn.eVstop),c=parseInt(inhomSpectr.numPoints),b=(b-a)/(c-1),d;inhomSpectr.eVarr=[];for(var e=0;e<c;e++)d=a+e*b,inhomSpectr.eVarr.push(d)}function tune_Etr(a){}function makeSommer(){var a=parseInt(inhomSpectr.numPoints),b=parseFloat(simSettn.eTr),c=parseFloat(simSettn.exEb),d;inhomSpectr.exenArr=[];for(var e=0;e<a;e++)d=parseFloat(inhomSpectr.eVarr[e]),inhomSpectr.exenArr.push(Sommerf(d,b,c))}
function Sommerf(a,b,c){var d;d=0;"bulk"==simSettn.jdostype?a>b&&(d=Math.PI*Math.sqrt(c/1E3/(a-b)),d=2*d*Math.exp(d)/(Math.exp(d)-Math.exp(-d))):"qw"==simSettn.jdostype&&("TE"==simSettn.polarizat?a==b?d=2:a>b&&(d=Math.PI*Math.sqrt(c/1E3/(a-b)),d=2*Math.exp(d)/(Math.exp(d)+Math.exp(-d))):a>b&&(d=Math.PI*Math.sqrt(c/1E3/(a-b+simSettn.ex0/1E3)),d=2*Math.exp(d)/(Math.exp(d)+Math.exp(-d)),d*=1+4*c/(a-b+simSettn.ex0/1E3)/1E3));return d.toFixed(7)}
function makeBoltz(){var a=parseFloat(simSettn.eTr),b=parseFloat(simSettn.kelvin),c=parseInt(inhomSpectr.numPoints),d,e=0;inhomSpectr.fcvArr=[];for(var f=0;f<c;f++)d=parseFloat(inhomSpectr.eVarr[f]),0<b?inhomSpectr.fcvArr.push(Boltzman(d,a,b)):d<a||0<e?inhomSpectr.fcvArr.push(1E-30):(inhomSpectr.fcvArr.push(1),e=1)}function Boltzman(a,b,c){var d=0;0<=a-b&&(d=Math.exp(-eCha*(a-b)/(kBoltz*c)));return d}
function makeJdos(){inhomSpectr.jdosArr=[];for(var a,b=parseInt(inhomSpectr.numPoints),c=parseFloat(simSettn.eTr),d=simSettn.jdostype,e=0;e<b;e++)a=parseFloat(inhomSpectr.eVarr[e]),inhomSpectr.jdosArr.push(Jdos(c,a,d))}function padArray(a){for(var b=[],c,d=0;d<fftN;d++)c=d<a.length?parseFloat(a[d]):d<(fftN+a.length)/2?parseFloat(a[a.length-1]):0,b.push(c);return b}function unPad(a){return a.slice(0,inhomSpectr.numPoints)}
function makeFftKernel(a){for(var b=Array(fftN),c=(parseFloat(simSettn.eVstop)-parseFloat(simSettn.eVstart))/(parseInt(inhomSpectr.numPoints)-1),d=0,e=0;e<fftN;e++)b[e]=e<fftN/2?a(-e*c):a(-(e-fftN)*c),d+=b[e];for(e=0;e<fftN;e++)b[e]/=d;return b}function fftConvo(a,b){var c=Array(fftN),d=0,e;for(e=0;e<b.length;e++)d+=b[e];convolveReal(a,b,c);for(e=0;e<fftN;e++)c[e]/=d,0>=c[e]&&(c[e]=1E-100);return c}function Jdos(a,b,c){var d=0;b>=a&&(d="bulk"==c?Math.sqrt(b-a):1);return d.toFixed(7)}
function makeLih(){var a=parseFloat(simSettn.eTr),b=parseInt(inhomSpectr.numPoints),c;inhomSpectr.Lih=[];for(var d=0;d<b;d++)c=parseFloat(inhomSpectr.eVarr[d]),$("#pltUrbach").prop("checked")?inhomSpectr.Lih.push(Urbach(a-c)):$("#pltsUrbach").prop("checked")?inhomSpectr.Lih.push(symUrbach(a-c)):$("#pltGaussian").prop("checked")&&inhomSpectr.Lih.push(Gaussian(a-c));$("#pltSech").prop("checked")&&(a=sechFun(),inhomSpectr.Lih=sechUnpad(a))}
function broadFuns(a){for(var b=parseFloat(simSettn.eTr),c=parseFloat(simSettn.eVstart),d=parseFloat(simSettn.eVstop),e=parseInt(inhomSpectr.numPoints),d=(d-c)/(e-1),f=0,g,h=-1,l=[],k=0;k<e;k++){g=b-(c+k*d);switch(a){case "Lorentz":f=Lorentz(g);break;case "Dlorentz":f=Dlorentz(g)}h=h>f?h:f;l.push(f)}0< !h&&(h=1);homSpectr.plotArr=[];for(k=0;k<e;k++)homSpectr.plotArr.push(l[k]/h)}
function LinOrLog(a){for(var b=[],c=0,d=0;d<inhomSpectr.numPoints;d++){var e=[];e.push(parseFloat(inhomSpectr.eVarr[d]));e.push(parseFloat(a[d]));b.push(e);c=c<e[1]?e[1]:c}c=Math.ceil(Math.log10(c));a=c-5;if("log"==graphSettn.inhomLinlog){for(d=0;d<inhomSpectr.numPoints;d++)b[d][1]=1E-6<b[d][1]?Math.log10(b[d][1]):-6;plot.getAxes().yaxis.options.min=a;plot.getAxes().yaxis.options.max=c}else plot.getAxes().yaxis.options.min=null,plot.getAxes().yaxis.options.max=null;return b}
function LinOrLogs(a,b,c){for(var d=[],e=0,f=inhomSpectr.numPoints,g=0;g<f;g++){var h=[];h.push(parseFloat(inhomSpectr.eVarr[g]));h.push(parseFloat(b[g]));d.push(h);e=e<h[1]?h[1]:e}e=Math.ceil(Math.log10(e));b=e-5;if("log"==a){for(g=0;g<f;g++)d[g][1]=1E-6<d[g][1]?Math.log10(d[g][1]):-6;c.getAxes().yaxis.options.min=b;c.getAxes().yaxis.options.max=e}else c.getAxes().yaxis.options.min=0,c.getAxes().yaxis.options.max=null;return d}
function LinOrLogExp(a,b){for(var c=[],d=1;d<a.length;d++){var e=[];e.push(a[d][0]);e.push(a[d][1]);c.push(e)}if("log"==b)for(d=0;d<a.length-1;d++)c[d][1]=1E-6<c[d][1]?Math.log10(c[d][1]):-6;return c}function Urbach(a){var b=0,c=parseFloat(simSettn.eU);0<=a&&(b=1E3*Math.exp(1E3*-a/c)/c);return b}function symUrbach(a){var b=parseFloat(simSettn.eU);return 500*Math.exp(1E3*-Math.abs(a)/b)/b}function Lorentz(a){var b=1E-15*simSettn.LorTau;return eCha*hBar*b/Math.PI/(hBar*hBar+b*b*a*a*eCha*eCha)}
function Dlorentz(a){var b=1E-15*simSettn.DlTau1,c=1E-15*simSettn.DlTau2;return eCha*(b+c)/Math.PI/hBar/(1+b*b*a*a/hBar/hBar*eCha*eCha)/(1+c*c*a*a/hBar/hBar*eCha*eCha)}function Gaussian(a){var b=simSettn.GauSig/1E3;return Math.exp(-a*a/2/b/b)/b/Math.sqrt(2*Math.PI)}
function sechFun(){for(var a=simSettn.SechN,b=hPlanck/(fftN*(simSettn.eVstop-simSettn.eVstart)/(inhomSpectr.numPoints-1)*eCha),b=b/a/(1E-15*simSettn.SechTau),c=[],d=[],e,f=0;f<fftN;f++)e=(f-fftN/2)*b,e=e<Math.log(1E300)&&e>Math.log(1E-300)?Math.pow(2/(Math.exp(e)+Math.exp(-e)),a):1E-300,c.push(e),d.push(0);transform(c,d);return[c,d]}
function sechUnpad(a){for(var b=parseFloat(simSettn.eTr),c=parseInt(inhomSpectr.numPoints),d=[],e,b=(b-simSettn.eVstart)/(simSettn.eVstop-simSettn.eVstart)*c,b=Math.round(b),f=0;f<c;f++)e=b-f,e=0<e?a[0][fftN-1-e]*a[0][fftN-1-e]+a[1][fftN-1-e]*a[1][fftN-1-e]:a[0][-e]*a[0][-e]+a[1][-e]*a[1][-e],d.push(Math.sqrt(e));return d}
$.each(plot.getAxes(),function(a,b){if(b.show){var c=b.box;$("<div class='axisTarget' style='position:absolute; left:"+c.left+"px; top:"+c.top+"px; width:"+c.width+"px; height:"+c.height+"px'></div>").data("axis.direction",b.direction).data("axis.n",b.n).css({backgroundColor:"#f00",opacity:0,cursor:"pointer"}).appendTo(plot.getPlaceholder()).hover(function(){$(this).css({opacity:.1});"y"==b.direction?showTooltip(c.left+c.width,c.top+c.height/2,"Click to toggle lin/log"):showTooltip(c.left+c.width/
2,c.top-c.height,"Click to edit graph")},function(){$(this).css({opacity:0});$("#tooltip").remove()}).click(function(){"y"==b.direction?(graphSettn.inhomLinlog="lin"==graphSettn.inhomLinlog?"log":"lin",inhombr()):inhomSettns_dialog()})}});
$.each(plot2.getAxes(),function(a,b){if(b.show){var c=b.box;$("<div class='axisTarget' style='position:absolute; left:"+c.left+"px; top:"+c.top+"px; width:"+c.width+"px; height:"+c.height+"px'></div>").data("axis.direction",b.direction).data("axis.n",b.n).css({backgroundColor:"#f00",opacity:0,cursor:"pointer"}).appendTo(plot2.getPlaceholder()).hover(function(){$(this).css({opacity:.1});"y"==b.direction?showTooltip2(c.left+c.width,c.top+c.height/2,"Click to toggle lin/log"):showTooltip2(c.left+c.width/
2,c.top-c.height,"Click to edit graph")},function(){$(this).css({opacity:0});$("#tooltip").remove()}).click(function(){"y"==b.direction?(graphSettn.homLinlog="lin"==graphSettn.homLinlog?"log":"lin",hombr()):homogSettns_dialog()})}});inhombr();$("#ph1_inhomog").mouseleave(function(){$("#tooltip").remove()});$("#ph2_homog").mouseleave(function(){$("#tooltip").remove()});
$("#ph1_inhomog").bind("plothover",function(a,b,c){showTooltip(40,30,"DblClick to edit graph");c&&(a="E: "+b.x.toFixed(4)+" val: "+b.y.toFixed(4),showTooltip(40,30,a))});$("#ph2_homog").bind("plothover",function(a,b,c){showTooltip2(40,30,"DblClick to edit graph");c&&(a="E: "+b.x.toFixed(4)+" val: "+b.y.toFixed(4),showTooltip2(100,30,a))});
function showTooltip(a,b,c){0<$("#tooltip").length&&$("#tooltip").remove();$('<div id="tooltip">'+c+"</div>").css({position:"absolute",display:"none",top:b+5,left:a+5,border:"1px solid #fdd",padding:"2px","background-color":"#fee",opacity:.8}).appendTo("#ph1_inhomog").fadeIn(200)}
function showTooltip2(a,b,c){0<$("#tooltip").length&&$("#tooltip").remove();$('<div id="tooltip">'+c+"</div>").css({position:"absolute",display:"none",top:b+5,left:a+5,border:"1px solid #fdd",padding:"2px","background-color":"#fee",opacity:.8}).appendTo("#ph2_homog").fadeIn(200)}
function setChkboxes(){$("#pltEpsilon").prop("checked",inhomSpectr.inPlot.eV);$("#pltJdos").prop("checked",inhomSpectr.inPlot.jdos);$("#pltSommerf").prop("checked",inhomSpectr.inPlot.Se);$("#pltFcv").prop("checked",inhomSpectr.inPlot.fcv);$("#pltUrbach").prop("checked",inhomSpectr.inPlot.Lurb);$("#pltsUrbach").prop("checked",inhomSpectr.inPlot.Lsurb);$("#pltGaussian").prop("checked",inhomSpectr.inPlot.Lgaus);$("#pltSech").prop("checked",inhomSpectr.inPlot.Lsech)}
function setLegend(){graphSettn.inhomLegend="";inhomSpectr.inPlot.eV&&(graphSettn.inhomLegend="E");inhomSpectr.inPlot.jdos&&(graphSettn.inhomLegend+="\u00b7Jdos");inhomSpectr.inPlot.Se&&(graphSettn.inhomLegend+="\u00b7Se");inhomSpectr.inPlot.fcv&&(graphSettn.inhomLegend+="\u00b7Fcv");!inhomSpectr.inPlot.Lurb&&!inhomSpectr.inPlot.Lsurb||inhomSpectr.inPlot.convo||(graphSettn.inhomLegend="Lih");graphSettn.inhomLegend.trim();graphSettn.inhomLegend=graphSettn.inhomLegend.replace(/^\u00B7+/,"");inhomSpectr.inPlot.convo&&
(graphSettn.inhomLegend="("+graphSettn.inhomLegend+")*Lih")}function multPlotted(a){num=inhomSpectr.numPoints;if(1>inhomSpectr.plotArr.length)for(var b=0;b<num;b++)inhomSpectr.plotArr.push(a[b]);else for(b=0;b<num;b++)inhomSpectr.plotArr[b]*=a[b]}
function calcInhom(){inhomSpectr.plotArr=[];inhomSpectr.inPlot.eV&&multPlotted(inhomSpectr.eVarr);inhomSpectr.inPlot.jdos&&multPlotted(inhomSpectr.jdosArr);inhomSpectr.inPlot.Se&&multPlotted(inhomSpectr.exenArr);inhomSpectr.inPlot.fcv&&multPlotted(inhomSpectr.fcvArr);!inhomSpectr.inPlot.convo&&(inhomSpectr.inPlot.Lurb||inhomSpectr.inPlot.Lsurb||inhomSpectr.inPlot.Lgaus||inhomSpectr.inPlot.Lsech)&&(makeLih(),inhomSpectr.plotArr=[],multPlotted(inhomSpectr.Lih));if(inhomSpectr.inPlot.convo){var a=[],
b=padArray(inhomSpectr.plotArr);if(inhomSpectr.inPlot.Lsurb)a=makeFftKernel(symUrbach);else if(inhomSpectr.inPlot.Lurb)a=makeFftKernel(Urbach);else if(inhomSpectr.inPlot.Lgaus)a=makeFftKernel(Gaussian);else if(inhomSpectr.inPlot.Lsech)for(var c=sechFun(),d=0;d<fftN;d++)a.push(Math.sqrt(c[0][d]*c[0][d]+c[1][d]*c[1][d]));inhomSpectr.plotArr=unPad(fftConvo(b,a))}$("#pltNormalize").is(":checked")&&arrNormalize(inhomSpectr.plotArr);inhombr();$("#pltHomConv").prop("checked")&&(calcHom(),hombr())}
function arrNormalize(a){var b=a.length,c=0,d;for(d=0;d<b;d++)c=a[d]>c?c=a[d]:c;for(d=0;d<b;d++)a[d]/=c}
$("#pltUrbach, #pltsUrbach, #pltGaussian, #pltSech").click(function(){"pltUrbach"==$(this).attr("id")&&1==$(this).prop("checked")&&$("#pltsUrbach, #pltGaussian, #pltSech").prop("checked",!1);"pltsUrbach"==$(this).attr("id")&&1==$(this).prop("checked")&&$("#pltUrbach, #pltGaussian, #pltSech").prop("checked",!1);"pltGaussian"==$(this).attr("id")&&1==$(this).prop("checked")&&$("#pltUrbach, #pltsUrbach, #pltSech").prop("checked",!1);"pltSech"==$(this).attr("id")&&1==$(this).prop("checked")&&$("#pltUrbach, #pltGaussian, #pltsUrbach").prop("checked",
!1);setLegend();calcInhom()});$("#pltHomConv").click(function(){$(this).is(":checked")?homSpectr.inPlot.convo=!0:homSpectr.inPlot.convo=!1});
$("#pltEpsilon, #pltJdos, #pltSommerf, #pltFcv, #pltUrbach, #pltsUrbach, #pltGaussian, #pltSech").change(function(){inhomSpectr.inPlot.eV=$("#pltEpsilon").prop("checked")?!0:!1;inhomSpectr.inPlot.jdos=$("#pltJdos").prop("checked")?!0:!1;inhomSpectr.inPlot.Se=$("#pltSommerf").prop("checked")?!0:!1;inhomSpectr.inPlot.fcv=$("#pltFcv").prop("checked")?!0:!1;inhomSpectr.inPlot.Lurb=$("#pltUrbach").prop("checked")?!0:!1;inhomSpectr.inPlot.Lsurb=$("#pltsUrbach").prop("checked")?!0:!1;inhomSpectr.inPlot.Lgaus=
$("#pltGaussian").prop("checked")?!0:!1;inhomSpectr.inPlot.Lsech=$("#pltSech").prop("checked")?!0:!1;inhomSpectr.inPlot.convo=!1;!(inhomSpectr.inPlot.eV||inhomSpectr.inPlot.jdos||inhomSpectr.inPlot.Se||inhomSpectr.inPlot.fcv)||1!=inhomSpectr.inPlot.Lurb&&1!=inhomSpectr.inPlot.Lsurb&&1!=inhomSpectr.inPlot.Lgaus&&1!=inhomSpectr.inPlot.Lsech||(inhomSpectr.inPlot.convo=!0);setLegend();calcInhom()});
$("#pltLorentz, #pltDlorentz").change(function(){var a=$(this).is(":checked");$("#pltLorentz, #pltDlorentz").prop("checked",!1);$(this).prop("checked",a);if($(this).is(":checked"))switch($(this).attr("id")){case "pltLorentz":if($("#pltHomConv").is(":checked")){var a=makeFftKernel(Lorentz),b=padArray(inhomSpectr.plotArr);homSpectr.plotArr=unPad(fftConvo(b,a))}else broadFuns("Lorentz");break;case "pltDlorentz":$("#pltHomConv").is(":checked")?(a=makeFftKernel(Dlorentz),b=padArray(inhomSpectr.plotArr),
homSpectr.plotArr=unPad(fftConvo(b,a))):broadFuns("Dlorentz")}else homSpectr.plotArr=[];hombr()});$("#pltHomConv").click(function(){homSpectr.inPlot.convo=$(this).is(":checked")});
$("#pltHomConv").change(function(){if($("#pltDlorentz").is(":checked")||$("#pltLorentz").is(":checked"))if(1==homSpectr.inPlot.convo){var a=$("#pltLorentz").is(":checked")?makeFftKernel(Lorentz):makeFftKernel(Dlorentz),b=padArray(inhomSpectr.plotArr);homSpectr.plotArr=unPad(fftConvo(b,a))}else $("#pltLorentz").is(":checked")?broadFuns("Lorentz"):$("#pltDlorentz").is(":checked")&&broadFuns("Dlorentz");else homSpectr.plotArr=[];hombr()});
$("#pltNormalize").change(function(){$(this).is(":checked")?(arrNormalize(inhomSpectr.plotArr),inhombr()):calcInhom()});
function calcHom(){var a=$("#pltLorentz").is(":checked"),a=a||$("#pltDlorentz").is(":checked");if($("#pltHomConv").is(":checked")&&a){if($("#pltLorentz").is(":checked"))var b=makeFftKernel(Lorentz),c=padArray(inhomSpectr.plotArr);else $("#pltDlorentz").is(":checked")&&(b=makeFftKernel(Dlorentz),c=padArray(inhomSpectr.plotArr));homSpectr.plotArr=unPad(fftConvo(c,b))}else $("#pltLorentz").is(":checked")?broadFuns("Lorentz"):$("#pltDlorentz").is(":checked")&&broadFuns("Dlorentz");hombr()}
function makeExpArrs(){var a=inhomSpectr.experPlot.length,b=homSpectr.experPlot.length,c=inhomSpectr.numPoints-1;inhomSpectr.experArr=[];homSpectr.experArr=[];for(var d=0;d<a;d++){var e=[];0<a&&inhomSpectr.experPlot[d][0]>inhomSpectr.eVarr[0]&&inhomSpectr.experPlot[d][0]<inhomSpectr.eVarr[c]&&(e.push(inhomSpectr.experPlot[d][0]),e.push(inhomSpectr.experPlot[d][1]),inhomSpectr.experArr.push(e))}for(a=0;a<b;a++)d=[],0<b&&homSpectr.experPlot[a][0]>inhomSpectr.eVarr[0]&&homSpectr.experPlot[a][0]<inhomSpectr.eVarr[c]&&
(d.push(homSpectr.experPlot[a][0]),d.push(homSpectr.experPlot[a][1]),homSpectr.experArr.push(d))}
$("#rangeok, #evetok, #jdosok, #exenhaok, #urbachok, #sUrbachok, #whatok").click(function(){var a,b;switch($(this).attr("id")){case "rangeok":a=Number($("#eVstart_touch").val());b=Number($("#eVstop_touch").val());.1<b-a&&(simSettn.eVstart=a.toFixed(3),simSettn.eVstop=b.toFixed(3));.1<=Math.abs(a-b)?a>b?(simSettn.eVstart=b.toFixed(3),simSettn.eVstop=a.toFixed(3)):(simSettn.eVstart=a.toFixed(3),simSettn.eVstop=b.toFixed(3)):b>a&&.1<b?(simSettn.eVstop=b.toFixed(3),simSettn.eVstart=(b-.1).toFixed(3)):
(simSettn.eVstart=a.toFixed(3),simSettn.eVstop=(a+.1).toFixed(3));makespArr();makeExpArrs();makeJdos();makeBoltz();makeSommer();calcInhom();calcHom();$("#spRange").css("display","none");$("#paramDial").dialog("close");break;case "evetok":a=Number($("#Et_touch").val());simSettn.eTr=a.toFixed(3);a=Number($("#TemK_touch").val());simSettn.kelvin=a.toFixed(3);makeJdos();makeBoltz();makeSommer();calcInhom();calcHom();$("#eg_et").css("display","none");$("#paramDial").dialog("close");break;case "jdosok":$("#spJdos").css("display",
"none");$("#paramDial").dialog("close");makeJdos();calcInhom();calcHom();break;case "exenhaok":a=Number($("#eVbind_touch").val());simSettn.exEb=a.toFixed(3);a=Number($("#ex0_touch").val());simSettn.ex0=a.toFixed(3);$("#exEnha").css("display","none");$("#paramDial").dialog("close");makeSommer();calcInhom();calcHom();break;case "urbachok":case "sUrbachok":a=Number($("#eveu_touch").val()),simSettn.eU=a.toFixed(3),$("#spUrbach").css("display","none"),$("#urbachAsymm,#urbachSymm").css("display","none"),
$("#paramDial").dialog("close"),calcInhom(),calcHom()}$("#settnDial").dialog("close");$("#paramDial").dialog("close")});$("#lorentzok").click(function(){$("#spLorentz").css("display","none");$("#paramDial").dialog("close");calcHom()});$("#dlorentzok").click(function(){$("#spDlorentz").css("display","none");$("#paramDial").dialog("close");calcHom()});$("#gaussianok").click(function(){$("#spGaussian").css("display","none");$("#paramDial").dialog("close");calcInhom();calcHom()});
$("#sechok").click(function(){$("#spSech").css("display","none");$("#paramDial").dialog("close");calcInhom();calcHom()});$("#hrefEpsilon").click(function(){$("#settnDial").dialog("close");$("#spRange").css("display","block");$("#paramDial").dialog("option","title","Spectral range in eV:");$("#paramDial").dialog("open");setJdosRadio()});
$("#hrefJdos").click(function(){$("#spJdos").css("display","block");$("#settnDial").dialog("close");$("#paramDial").dialog("option","title","Joint density of states (JDOS):");$("#paramDial").dialog("open");setJdosRadio()});
$("#hrefSommerf").click(function(){$("#exEnha").css("display","block");$("#settnDial").dialog("close");"bulk"==simSettn.jdostype?$("#paramDial").dialog("option","title","Exciton enhancement for bulk (3D-exciton model):"):$("#paramDial").dialog("option","title","Exciton enhancement for QW-material (2D-exciton model):");$("#paramDial").dialog("open");setJdosRadio();setQwRadio()});
$("#hrefTransito").click(function(){$("#eg_et").css("display","block");$("#settnDial").dialog("close");$("#paramDial").dialog("option","title","Parameters for Boltzmann distribution:");$("#paramDial").dialog("open");setJdosRadio();setQwRadio()});
$("#hrefUrbach").click(function(){$("#spUrbach, #spLorentz, #spSurbach, #spDlorentz, #spGaussian, #spSech").css("display","none");$("#paramDial").dialog("option","title","Parameters for asymmetric Urbach tail inhomogeneous broadening:");$("#urbachSymm").css("display","none");$("#urbachAsymm").css("display","block");$("#settnDial").dialog("close");$("#spUrbach").css("display","block");$("#paramDial").dialog("open")});
$("#hrefsUrbach").click(function(){$("#spUrbach, #spLorentz, #spSurbach, #spDlorentz, #spGaussian, #spSech").css("display","none");$("#paramDial").dialog("option","title","Parameters for symmetric Urbach tail inhomogeneous broadening:");$("#settnDial").dialog("close");$("#urbachAsymm").css("display","none");$("#urbachSymm").css("display","block");$("#spUrbach").css("display","block");$("#paramDial").dialog("open")});
$("#hrefLorentz").click(function(){$("#spUrbach, #spLorentz, #spSurbach, #spDlorentz, #spGaussian, #spSech").css("display","none");$("#settnDial").dialog("close");$("#spLorentz").css("display","block");$("#paramDial").dialog("option","title","Parameters for Lorentzian broadening function:");$("#paramDial").dialog("open")});
$("#hrefdLorentz").click(function(){$("#spUrbach, #spLorentz, #spSurbach, #spDlorentz, #spGaussian, #spSech").css("display","none");$("#settnDial").dialog("close");$("#spDlorentz").css("display","block");$("#paramDial").dialog("option","title","Parameters for LxL, (product of two Lorentzians) broadening function:");$("#paramDial").dialog("open")});
$("#hrefGaussian").click(function(){$("#spUrbach, #spLorentz, #spSurbach, #spDlorentz, #spGaussian, #spSech").css("display","none");$("#settnDial").dialog("close");$("#spGaussian").css("display","block");$("#paramDial").dialog("option","title","Parameters for Gaussian inhomogeneous broadening:");$("#paramDial").dialog("open")});
$("#hrefSech").click(function(){$("#spUrbach, #spLorentz, #spSurbach, #spDlorentz, #spGaussian, #spSech").css("display","none");$("#settnDial").dialog("close");$("#paramDial").dialog("option","title","Parameters for broadening from sech^n time relaxation:");$("#spSech").css("display","block");$("#paramDial").dialog("open")});
$("#emisLocFiles").on("change",function(){var a=$("#emisLocFiles").get(0).files[0];if(a){var b=$("#settnDial").dialog("option","title");"Inhomogeneous spectrum"==b?$("#radioMeas").is(":checked")?(graphSettn.inhomFileN=a.name,ReadLocFle(a,gotInhomFile)):ReadLocFle(a,gotInhomSim):"Homogeneous spectrum"==b&&($("#radioMeas").is(":checked")?(graphSettn.homFileN=a.name,ReadLocFle(a,gotHomogFile)):ReadLocFle(a,gotInhomSim))}});$("#footer").prepend("Flot graph"+$.plot.version+" &ndash; ");
function gotInhomFile(a){try{inhomSpectr.experArr=splitToArr(a);inhomSpectr.experPlot=splitToArr(a);var b=inhomSpectr.experPlot[0][2],b=b.replace(/"/g,"");$("#inhDescLbl").css("display","inline");$("#inhDesc").css("display","inline");$("#inhDesc").html(b);inhombr()}catch(c){alert("Error in selected inhomogeneous emission data")}}
function gotHomogFile(a){try{homSpectr.experArr=splitToArr(a);homSpectr.experPlot=splitToArr(a);var b=homSpectr.experPlot[0][2],b=b.replace(/"/g,"");$("#homDescLbl").css("display","inline");$("#homDesc").css("display","inline");$("#homDesc").html(b);hombr()}catch(c){alert("Error in selected homogeneous emission data")}}
function gotInhomSim(a){var b=a.indexOf("Header:"),c=a.indexOf("Parameters:");try{if(0>b||0>c)throw"Error in simulation settings file";var d=a.substring(c+11,a.length),d=d.trim(),e=a.substring(b+7,a.length),e=e.trim();setSettings(d);setSelections(e);setChkboxes();setLegend();makespArr();makeExpArrs();makeJdos();makeBoltz();makeSommer();calcInhom();calcHom();inhombr();hombr()}catch(f){alert("Error in processing simulation settings file")}}
function setSelections(a){inhomSpectr.inPlot.eV=0<=a.indexOf("(E)")?!0:!1;inhomSpectr.inPlot.jdos=0<=a.indexOf("(qw-jdos)")?!0:!1;inhomSpectr.inPlot.fcv=0<=a.indexOf("(exp[(E-Etr)/kT])")?!0:!1;inhomSpectr.inPlot.Se=0<=a.indexOf("(qw-ex.Enh)")?!0:!1;inhomSpectr.inPlot.convo=!1;inhomSpectr.inPlot.Lurb=!1;inhomSpectr.inPlot.Lsurb=!1;inhomSpectr.inPlot.Lgaus=!1;inhomSpectr.inPlot.Lsech=!1;homSpectr.inPlot.convo=!1;$("#pltHomConv").prop("checked",!1);$("#pltDlorentz").prop("checked",!1);$("#pltLorentz").prop("checked",
!1);0<=a.indexOf("*(Asym.Urbach-brdng)")&&(inhomSpectr.inPlot.convo=!0,inhomSpectr.inPlot.Lurb=!0);0<=a.indexOf("*(Symm.Urbach-brdng)")&&(inhomSpectr.inPlot.convo=!0,inhomSpectr.inPlot.Lsurb=!0);0<=a.indexOf("*(Gaussian-brdng)")&&(inhomSpectr.inPlot.convo=!0,inhomSpectr.inPlot.Lgaus=!0);0<=a.indexOf("*(Sech^n(t/tau/n)-brdng)")&&(inhomSpectr.inPlot.convo=!0,inhomSpectr.inPlot.Lsech=!0);0<=a.indexOf("*(Lorentzian brdng)")&&(homSpectr.inPlot.convo=!0,$("#pltHomConv").prop("checked",!0),$("#pltLorentz").prop("checked",
!0));0<=a.indexOf("*(Lorentzian1 x Lorentzian2 brdng)")&&(homSpectr.inPlot.convo=!0,$("#pltHomConv").prop("checked",!0),$("#pltDlorentz").prop("checked",!0))}
function setSettings(a){a=JSON.parse(a);simSettn.eVstart=a.Estart;$("#eVstart_touch").val(simSettn.eVstart);simSettn.eVstop=a.Estop;$("#eVstop_touch").val(simSettn.eVstop);simSettn.eTr=a.Boltzmann.Epeak_eV;$("#Et_touch").val(simSettn.eTr);simSettn.jdostype=a.jdos&&"qw"==a.jdos?"qw":"bulk";setJdosRadio();a.exiton&&(simSettn.exEb=a.exiton.Eb_meV,$("#eVbind_touch").val(a.exiton.Eb_meV),"QW-2D"==a.exiton.type&&(simSettn.viewDir=a.exiton.viewDir,"parallel"==a.exiton.viewDir?$("#dirPar").prop("checked",
!0):$("#dirPerp").prop("checked",!0),simSettn.polarizat=a.exiton.polarizat,"TM"==a.exiton.polarizat?(simSettn.ex0=a.exiton.shapePar,$("#haideri").css("display","inline"),$("#ex0_touch").val(simSettn.ex0),$("enhTM").prop("checked",!0)):($("#haideri").css("display","none"),$("enhTE").prop("checked",!0))));a.Boltzmann&&(simSettn.kelvin=a.Boltzmann.Temp_K,$("#TemK_touch").val(simSettn.kelvin));if(a.InhmgBrdng){if("SymmUrbach"==a.InhmgBrdng.type||"AsymUrbach"==a.InhmgBrdng.type)simSettn.eU=a.InhmgBrdng.Eu_meV,
$("#eveu_touch").val(simSettn.eU);"Gaussian"==a.InhmgBrdng.type&&(simSettn.GauSig=a.InhmgBrdng.sigma_meV,$("#gausig_touch").val(simSettn.GauSig));"Sech^n(t/tau)"==a.InhmgBrdng.type&&(simSettn.SechTau=a.InhmgBrdng.tau_fs,simSettn.SechN=a.InhmgBrdng.n,$("#sechTau_touch").val(simSettn.SechTau),$("#sechN_touch").val(simSettn.SechN))}a.HomogBrdng&&("Lorentz X Lorentz"==a.HomogBrdng.type&&($("#pltDlorentz").prop("checked",!0),$("#pltLorentz").prop("checked",!1),simSettn.DlTau1=a.HomogBrdng.tau1_fs,$("#tauBe_touch").val(simSettn.DlTau1),
simSettn.DlTau2=a.HomogBrdng.tau2_fs,$("#tauBh_touch").val(simSettn.DlTau2)),"Lorentz"==a.HomogBrdng.type&&(simSettn.LorTau=a.HomogBrdng.tau_fs,$("#pltLorentz").prop("checked",!0),$("#pltDlorentz").prop("checked",!1),$("#TauR_touch").val(simSettn.LorTau)))}function gotHomogSim(a){};
